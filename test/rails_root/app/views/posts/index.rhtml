<h1>Listing posts</h1>

<% cache('total_posts') do -%>
<div>
	Total posts: @posts.size
</div>
<% end -%>

<table>
  <tr>
    <th>User</th>
    <th>Title</th>
    <th>Body</th>
  </tr>
  
<% for post in @posts %>
	<% cache(:fragment => 'posts', :id => post.id) do -%>
	  <tr>
	    <td><%=h post.user_id %></td>
	    <td><%=h post.title %></td>
	    <td><%=h post.body %></td>
	    <td><%= link_to 'Show', user_post_path(post.user, post) %></td>
	    <td><%= link_to 'Edit', edit_user_post_path(post.user, post) %></td>
	    <td><%= link_to 'Destroy', user_post_path(post.user, post), :confirm => 'Are you sure?', 
	                    :method => :delete %></td>
	  </tr>
	<% end -%>
<% end %>
</table>

<br />

<%= link_to 'New post', new_user_post_path(post.user) %>
